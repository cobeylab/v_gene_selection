#scale_y_continuous(expand = c(0.005,0)) +
theme(axis.text.x = element_text(size = 12),
legend.position = 'None') +
ylab('Fraction of cases') + xlab ('Age') +
scale_color_manual(name = '',
labels = c('B/Victoria','B/Yamagata'),
values = c('darkorange1','mediumpurple3'))
save_plot('../figures/age_distribution_nz_allsurveillance.pdf',aggregated_all_surveillance_distribution_by_age,
base_height = 4, base_width = 10)
aggregated_all_surveillance_distribution_by_age <- aggregated_all_surveillance_distribution_by_age %>%
ggplot(aes(x = cohort_value, y = fraction_cases)) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Victoria'),
fill = 'darkorange1', alpha = 0.8) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Yamagata'),
fill = 'mediumpurple3', alpha = 0.7) +
scale_x_continuous(expand = c(0.01,0), limits = c(-1,60)) +
#scale_y_continuous(expand = c(0.005,0)) +
theme(axis.text.x = element_text(size = 12),
legend.position = 'None') +
ylab('Fraction of cases') + xlab ('Age') +
scale_color_manual(name = '',
labels = c('B/Victoria','B/Yamagata'),
values = c('darkorange1','mediumpurple3'))
aggregated_all_surveillance_distribution_by_age %>%
ggplot(aes(x = cohort_value, y = fraction_cases)) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Victoria'),
fill = 'darkorange1', alpha = 0.8) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Yamagata'),
fill = 'mediumpurple3', alpha = 0.7) +
scale_x_continuous(expand = c(0.01,0), limits = c(-1,60)) +
#scale_y_continuous(expand = c(0.005,0)) +
theme(axis.text.x = element_text(size = 12),
legend.position = 'None') +
ylab('Fraction of cases') + xlab ('Age') +
scale_color_manual(name = '',
labels = c('B/Victoria','B/Yamagata'),
values = c('darkorange1','mediumpurple3'))
aggregated_all_surveillance_distribution_by_age %>%
ggplot(aes(x = cohort_value, y = fraction_cases)) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Victoria'),
fill = 'darkorange1', alpha = 0.8) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Yamagata'),
fill = 'mediumpurple3', alpha = 0.7) +
scale_x_continuous(expand = c(0.01,0), limits = c(-1,60))
aggregated_all_surveillance_distribution_by_age %>%
ggplot(aes(x = cohort_value, y = fraction_cases)) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Victoria'),
fill = 'darkorange1', alpha = 0.8) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Yamagata'),
fill = 'mediumpurple3', alpha = 0.7) +
scale_x_continuous(expand = c(0.01,0), limits = c(-1,60)) +
#scale_y_continuous(expand = c(0.005,0)) +
theme(axis.text.x = element_text(size = 12),
legend.position = 'None') +
ylab('Fraction of cases') + xlab ('Age') +
scale_color_manual(name = '',
labels = c('B/Victoria','B/Yamagata'),
values = c('darkorange1','mediumpurple3'))
aggregated_all_surveillance_distribution_by_age %>%
ggplot(aes(x = cohort_value, y = fraction_cases)) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Victoria'),
fill = 'darkorange1', alpha = 0.8) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Yamagata'),
fill = 'mediumpurple3', alpha = 0.7) +
scale_x_continuous(expand = c(0.01,0)) +
#scale_y_continuous(expand = c(0.005,0)) +
theme(axis.text.x = element_text(size = 12),
legend.position = 'None') +
ylab('Fraction of cases') + xlab ('Age') +
scale_color_manual(name = '',
labels = c('B/Victoria','B/Yamagata'),
values = c('darkorange1','mediumpurple3'))
aggregated_all_surveillance_distribution_by_age <- case_data_nz_all_surveillance %>%
group_by(lineage, cohort_value) %>%
summarise(n_cases = sum(n_cases, na.rm = T)) %>%
ungroup() %>% group_by(lineage) %>%
mutate(total_cases = sum(n_cases)) %>%
mutate(fraction_cases = n_cases/total_cases) %>%
ungroup()
aggregated_all_surveillance_distribution_histograms_by_age <- aggregated_all_surveillance_distribution_by_age %>%
ggplot(aes(x = cohort_value, y = fraction_cases)) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Victoria'),
fill = 'darkorange1', alpha = 0.8) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Yamagata'),
fill = 'mediumpurple3', alpha = 0.7) +
scale_x_continuous(expand = c(0.01,0), limits = c(-0.5,60)) +
#scale_y_continuous(expand = c(0.005,0)) +
theme(axis.text.x = element_text(size = 12),
legend.position = 'None') +
ylab('Fraction of cases') + xlab ('Age') +
scale_color_manual(name = '',
labels = c('B/Victoria','B/Yamagata'),
values = c('darkorange1','mediumpurple3'))
aggregated_all_surveillance_distribution_histograms_by_age <- aggregated_all_surveillance_distribution_by_age %>%
ggplot(aes(x = cohort_value, y = fraction_cases)) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Victoria'),
fill = 'darkorange1', alpha = 0.8) +
geom_col(data = aggregated_all_surveillance_distribution_by_age %>% filter(lineage == 'B/Yamagata'),
fill = 'mediumpurple3', alpha = 0.7) +
scale_x_continuous(expand = c(0.01,0), limits = c(-0.5,60)) +
#scale_y_continuous(expand = c(0.005,0)) +
theme(axis.text.x = element_text(size = 12),
legend.position = 'None') +
ylab('Fraction of cases') + xlab ('Age') +
scale_color_manual(name = '',
labels = c('B/Victoria','B/Yamagata'),
values = c('darkorange1','mediumpurple3'))
save_plot('../figures/age_distribution_nz_allsurveillance.pdf',aggregated_all_surveillance_distribution_histograms_by_age,
base_height = 4, base_width = 10)
setwd("/Volumes/cobey/mvieira/v_gene_selection/code")
library(dplyr)
library(tidyr)
library(readr)
library(ggplot2)
library(cowplot)
source('gene_frequency_functions.R')
seq_level_data <- read_csv('~/Desktop/seq_level_data.csv')
mouse_info <- get_info_from_mouse_id(seq_level_data %>% select(mouse_id) %>% unique())
seq_level_data <- left_join(mouse_info, seq_level_data, by = 'mouse_id') %>%
filter(productive_partis) %>% dplyr::rename(tissue = specimen_tissue, cell_type = specimen_cell_subset) %>%
mutate(group_controls_pooled = factor(group_controls_pooled, levels = group_controls_pooled_factor_levels))
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN')
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'PC')
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'PC') %>%
ggplot(aes(x = group_controls_pooled, y = n_mutations_partis)) +
geom_point()
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'PC') %>%
ggplot(aes(x = group_controls_pooled, y = n_mutations_partis)) +
geom_point() +
facet_wrap('cell_type')
plot(1:10)
plot(1:10)
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'PC') %>%
ggplot(aes(x = group_controls_pooled, y = n_mutations_partis)) +
geom_boxplot(aes(group = mouse_id)) +
facet_wrap('cell_type')
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'PC') %>%
ggplot(aes(x = group_controls_pooled, y = n_mutations_partis)) +
geom_violin(aes(group = mouse_id)) +
facet_wrap('cell_type')
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'PC') %>%
ggplot(aes(x = group_controls_pooled, y = n_mutations_partis)) +
geom_violin() +
facet_wrap('cell_type')
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'PC') %>%
ggplot(aes(x = group_controls_pooled, y = n_mutations_partis)) +
geom_violin() +
facet_wrap('cell_type') +
scale_y_log10()
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'PC') %>% filter(n_mutations_partis > 90)
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'PC') %>%
filter(n_mutations_partis > 0) %>%
ggplot(aes(x = group_controls_pooled, y = n_mutations_partis)) +
geom_violin() +
facet_wrap('cell_type') +
scale_y_log10()
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'GC') %>%
filter(n_mutations_partis > 0) %>%
ggplot(aes(x = group_controls_pooled, y = n_mutations_partis)) +
geom_violin() +
facet_wrap('cell_type') +
scale_y_log10()
mean_n_mutations <- seq_level_data %>% group_by(mouse_id, day, infection_status, group_controls_pooled, tissue, cell_type) %>%
summarise(mean_n_mutations = mean(n_mutations_partis))
mean_n_mutations
mean_n_mutations %>% ggplot(aes(x = group_controls_pooled, y = mean_n_mutations)) +
geom_point() +
facet_wrap(cell_type ~ tissue)
mean_n_mutations %>% ggplot(aes(x = group_controls_pooled, y = mean_n_mutations)) +
geom_point() +
facet_grid(cell_type ~ tissue)
mean_n_mutations %>% ggplot(aes(x = group_controls_pooled, y = mean_n_mutations)) +
geom_point() +
facet_grid(cell_type ~ tissue, scales = 'free')
theme_set(theme_cowplot())
mean_n_mutations %>% ggplot(aes(x = group_controls_pooled, y = mean_n_mutations)) +
geom_point() +
facet_grid(cell_type ~ tissue, scales = 'free')
seq_level_data <- seq_level_data %>% mutate(tissue = factor(tissue, levels = c('naive','GC','PC','mem')))
mean_n_mutations <- seq_level_data %>% group_by(mouse_id, day, infection_status, group_controls_pooled, tissue, cell_type) %>%
summarise(mean_n_mutations = mean(n_mutations_partis))
mean_n_mutations %>% ggplot(aes(x = group_controls_pooled, y = mean_n_mutations)) +
geom_point() +
facet_grid(tissue ~ cell_type, scales = 'free')
seq_level_data <- read_csv('../processed_data/seq_level_files/seq_level_data.csv')
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'GC') %>%
filter(n_mutations_partis > 0) %>%
ggplot(aes(x = group_controls_pooled, y = n_mutations_partis)) +
geom_violin() +
facet_wrap('cell_type') +
scale_y_log10()
mouse_info <- get_info_from_mouse_id(seq_level_data %>% select(mouse_id) %>% unique())
seq_level_data <- left_join(mouse_info, seq_level_data, by = 'mouse_id') %>%
filter(productive_partis) %>% dplyr::rename(tissue = specimen_tissue, cell_type = specimen_cell_subset) %>%
mutate(group_controls_pooled = factor(group_controls_pooled, levels = group_controls_pooled_factor_levels),
cell_type = factor(cell_type, levels = c('naive','GC','PC','mem')),
tissue = factor(tissue, levels = c('LN','spleen','BM')))
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'GC') %>%
filter(n_mutations_partis > 0) %>%
ggplot(aes(x = group_controls_pooled, y = n_mutations_partis)) +
geom_violin() +
facet_wrap('cell_type') +
scale_y_log10()
mean_n_mutations <- seq_level_data %>% group_by(mouse_id, day, infection_status, group_controls_pooled, tissue, cell_type) %>%
summarise(mean_n_mutations = mean(n_mutations_partis)) %>%
mutate(cell_t)
mean_n_mutations %>% ggplot(aes(x = group_controls_pooled, y = mean_n_mutations)) +
geom_point() +
facet_grid(tissue ~ cell_type, scales = 'free') +
background_grid()
seq_level_data
mean_n_mutations %>% ggplot(aes(x = group_controls_pooled, y = mean_n_mutations)) +
geom_point() +
facet_grid(tissue ~ cell_type, scales = 'free') +
background_grid()
mean_n_mutations <- seq_level_data %>% group_by(mouse_id, day, infection_status, group_controls_pooled, tissue, cell_type) %>%
summarise(mean_n_mutations = mean(n_mutations_partis)) %>%
mutate(cell_t)
mean_n_mutations <- seq_level_data %>% group_by(mouse_id, day, infection_status, group_controls_pooled, tissue, cell_type) %>%
summarise(mean_n_mutations = mean(n_mutations_partis))
mean_n_mutations %>% ggplot(aes(x = group_controls_pooled, y = mean_n_mutations)) +
geom_point() +
facet_grid(tissue ~ cell_type, scales = 'free') +
background_grid()
unique(seq_level_data$cell_type)
seq_level_data <- read_csv('~/Desktop/seq_level_data.csv')
unique(seq_level_data$specimen_cell_subset)
seq_level_data$specimen_cell_subset[seq_level_data$specimen_cell_subset == 'naïve']
seq_level_data$specimen_cell_subset[seq_level_data$specimen_cell_subset == 'naïve'] <- 'naive'
mouse_info <- get_info_from_mouse_id(seq_level_data %>% select(mouse_id) %>% unique())
seq_level_data <- left_join(mouse_info, seq_level_data, by = 'mouse_id') %>%
filter(productive_partis) %>% dplyr::rename(tissue = specimen_tissue, cell_type = specimen_cell_subset) %>%
mutate(group_controls_pooled = factor(group_controls_pooled, levels = group_controls_pooled_factor_levels),
cell_type = factor(cell_type, levels = c('naive','GC','PC','mem')),
tissue = factor(tissue, levels = c('LN','spleen','BM')))
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'GC') %>%
filter(n_mutations_partis > 0) %>%
ggplot(aes(x = group_controls_pooled, y = n_mutations_partis)) +
geom_violin() +
facet_wrap('cell_type') +
scale_y_log10()
mean_n_mutations <- seq_level_data %>% group_by(mouse_id, day, infection_status, group_controls_pooled, tissue, cell_type) %>%
summarise(mean_n_mutations = mean(n_mutations_partis))
mean_n_mutations %>% ggplot(aes(x = group_controls_pooled, y = mean_n_mutations)) +
geom_point() +
facet_grid(tissue ~ cell_type, scales = 'free') +
background_grid()
mean_n_mutations %>% ggplot(aes(x = group_controls_pooled, y = mean_n_mutations, color = infection_status)) +
geom_point() +
geom_boxplot() +
facet_grid(tissue ~ cell_type, scales = 'free') +
background_grid()
seq_level_data %>% filter(cell_type == 'naive') %>%
ggplot(aes(x = n_mutations_partis)) +
geom_histogram()
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, n_mutations_partis) %>%
summarise(n_seqs)
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, n_mutations_partis) %>%
summarise(n_seqs = n())
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, tissue, n_mutations_partis) %>%
summarise(n_seqs = n()) %>%
ungroup() %>%
group_by(mouse_id, tissue) %>%
mutate(fraction_seqs = n_seqs / sum(n_seqs))
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, tissue, n_mutations_partis) %>%
summarise(n_seqs = n()) %>%
ungroup() %>%
group_by(mouse_id, tissue) %>%
mutate(fraction_seqs = n_seqs / sum(n_seqs)) %>%
ungroup()
distribution_mutations_naive <- seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, tissue, n_mutations_partis) %>%
summarise(n_seqs = n()) %>%
ungroup() %>%
group_by(mouse_id, tissue) %>%
mutate(fraction_seqs = n_seqs / sum(n_seqs)) %>%
ungroup()
distribution_mutations_naive %>% filter(tissue == 'spleen')
seq_level_data %>%
filter(cell_type == 'naive')
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, tissue, n_mutations_partis) %>%
summarise(n_seqs = n())
distribution_mutations_naive %>% group_by(mouse_id, tissue) %>% sum(fraction_seqs)
distribution_mutations_naive %>% group_by(mouse_id, tissue) %>% summarise(sum(fraction_seqs))
distribution_mutations_naive %>% group_by(mouse_id, tissue) %>% summarise(S = sum(fraction_seqs)) %>% select(S) %>% unique()
distribution_mutations_naive %>% group_by(mouse_id, tissue) %>% summarise(S = sum(fraction_seqs)) %>% ungroup() %>% select(S) %>% unique()
distribution_mutations_naive <- seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, tissue, n_mutations_partis) %>%
summarise(n_seqs = n()) %>%
ungroup() %>%
group_by(mouse_id, tissue) %>%
mutate(fraction_seqs = n_seqs / sum(n_seqs)) %>%
ungroup()
distribution_mutations_naive
distribution_mutations_naive %>% filter(mouse_id == ' 16-2')
distribution_mutations_naive %>% filter(mouse_id == ' 16-3')
distribution_mutations_naive %>% filter(mouse_id == '16-3')
unique(distribution_mutations_naive$mouse_id)
distribution_mutations_naive %>% filter(mouse_id == '16-2')
distribution_mutations_naive %>% filter(mouse_id == '16-5')
distribution_mutations_naive %>% filter(mouse_id == '16-5', tissue == 'spleen')
seq_level_data
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, tissue, n_mutations_partis) %>%
summarise(n_seqs = n()) %>%
ungroup() %>%
group_by(mouse_id, tissue) %>%
mutate(fraction_seqs = n_seqs / sum(n_seqs)) %>%
ungroup()
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, tissue, n_mutations_partis) %>%
summarise(n_seqs = n()) %>%
ungroup() %>%
group_by(mouse_id, tissue) %>%
mutate(total_naive_seqs = sum(n_seqs),
fraction_seqs = n_seqs / total_naive_seqs) %>%
ungroup()
dbinom(0,44117,0.0018)
dbinom(0,100,0.0018)
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, tissue, n_mutations_partis) %>%
summarise(n_seqs = n()) %>%
ungroup() %>%
group_by(mouse_id, tissue) %>%
mutate(total_naive_seqs = sum(n_seqs),
fraction_seqs = n_seqs / total_naive_seqs) %>%
ungroup()
dbinom(0,100,0.003)
dbinom(0,100,0.01)
distribution_mutations_naive %>% arrange(desc(fraction_seqs))
distribution_mutations_naive %>% arrange(desc(fraction_seqs)) %>% head(20)
distribution_mutations_naive <- seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, tissue, n_mutations_partis) %>%
summarise(n_seqs = n()) %>%
ungroup() %>%
group_by(mouse_id, tissue) %>%
mutate(total_naive_seqs = sum(n_seqs),
fraction_seqs = n_seqs / total_naive_seqs) %>%
ungroup()
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, day, infection_status, group_controls_pooled, tissue, n_mutations_partis) %>%
summarise(n_seqs = n()) %>%
ungroup() %>%
group_by(mouse_id, day, infection_status, group_controls_pooled, tissue) %>%
mutate(total_naive_seqs = sum(n_seqs),
fraction_seqs = n_seqs / total_naive_seqs) %>%
ungroup()
# Distribution of mutations in naive sequences
distribution_mutations_naive <- seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, day, infection_status, group_controls_pooled, tissue, n_mutations_partis) %>%
summarise(n_seqs = n()) %>%
ungroup() %>%
group_by(mouse_id, day, infection_status, group_controls_pooled, tissue) %>%
mutate(total_naive_seqs = sum(n_seqs),
fraction_seqs = n_seqs / total_naive_seqs) %>%
ungroup()
distribution_mutations_naive %>% group_by(mouse_id, tissue) %>% summarise(S = sum(fraction_seqs))
distribution_mutations_naive %>% group_by(mouse_id, tissue) %>% summarise(S = sum(fraction_seqs)) %>% select(S) %>% unique()
distribution_mutations_naive %>% group_by(mouse_id, tissue) %>% summarise(S = sum(fraction_seqs)) %>% ungroup() %>% select(S) %>% unique()
distribution_mutations_naive %>%
filter(n_mutations_partis == 0)
# Plot with fraction of unmutate naive sequences by mouse / tissue
distribution_mutations_naive %>%
filter(n_mutations_partis == 0) %>%
ggplot(aes(x = group_controls_pooled, y = fraction_seqs, color = infection_status)) +
geom_point() +
facet_wrap('tissue') +
background_grid()
dbinom(0,100,0.0018)
# Plot with fraction of unmutate naive sequences by mouse / tissue
distribution_mutations_naive %>%
filter(n_mutations_partis == 0) %>%
ggplot(aes(x = group_controls_pooled, y = fraction_seqs, color = infection_status)) +
geom_boxplot(outlier.alpha = 0) +
geom_point() +
facet_wrap('tissue') +
background_grid()
# Distribution of mutations in naive sequences
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(n_mutations_partis) %>%
count()
# Distribution of mutations in naive sequences
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(n_mutations_partis) %>%
dplyr::count()
# Distribution of mutations in naive sequences
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(n_mutations_partis) %>%
dplyr::count() %>%
mutate(n = n/sum(n))
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(n_mutations_partis) %>%
dplyr::count()
# Distribution of mutations in naive sequences
seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(n_mutations_partis) %>%
dplyr::count() %>%
ungroup() %>%
mutate(fraction = n/sum(n))
# Distribution of mutations in naive sequences
seq_level_data %>%
filter(cell_type == 'naive', tissue != 'LN') %>%
group_by(n_mutations_partis) %>%
dplyr::count() %>%
ungroup() %>%
mutate(fraction = n/sum(n)) %>%
distribution_mutations_naive <- seq_level_data %>%
filter(cell_type == 'naive') %>%
group_by(mouse_id, day, infection_status, group_controls_pooled, tissue, n_mutations_partis) %>%
summarise(n_naive_seqs = n()) %>%
ungroup() %>%
group_by(mouse_id, day, infection_status, group_controls_pooled, tissue) %>%
mutate(total_naive_seqs = sum(n_naive_seqs),
fraction_seqs = n_naive_seqs / total_naive_seqs) %>%
ungroup()
seq_level_data %>%
filter(cell_type == 'naive', tissue != 'LN')
seq_level_data %>%
filter(cell_type == 'naive', tissue != 'LN') %>%
group_by(n_mutations_partis) %>%
dplyr::count() %>%
ungroup() %>%
mutate(fraction = n/sum(n))
# Distribution of mutations in naive sequences
seq_level_data %>%
filter(cell_type == 'naive', tissue != 'LN') %>%
group_by(n_mutations_partis) %>%
dplyr::count() %>%
ungroup() %>%
mutate(fraction = n/sum(n)) %>%
ggplot(aes(x = n_mutations_partis, y = n)) +
geom_col()
# Plot with fraction of unmutate naive sequences by mouse / tissue
distribution_mutations_naive %>%
filter(n_mutations_partis == 0) %>%
ggplot(aes(x = group_controls_pooled, y = fraction_seqs, color = infection_status)) +
geom_boxplot(outlier.alpha = 0) +
geom_point() +
facet_wrap('tissue') +
background_grid()
seq_level_data %>% filter(group_controls_pooled != 'control', tissue == 'LN', cell_type == 'GC') %>%
filter(n_mutations_partis > 0) %>%
ggplot(aes(x = group_controls_pooled, y = n_mutations_partis)) +
geom_violin() +
facet_wrap('cell_type') +
scale_y_log10()
mean_n_mutations <- seq_level_data %>% group_by(mouse_id, day, infection_status, group_controls_pooled, tissue, cell_type) %>%
summarise(mean_n_mutations = mean(n_mutations_partis))
mean_n_mutations %>% ggplot(aes(x = group_controls_pooled, y = mean_n_mutations, color = infection_status)) +
geom_point() +
geom_boxplot() +
facet_grid(tissue ~ cell_type, scales = 'free') +
background_grid()
seq_level_data %>%
filter(cell_type == 'naive') %>%
ggplot(aes(x = n_mutations_partis)) + geom_histogram()
?geom_histogram
seq_level_data %>%
filter(cell_type == 'naive') %>%
ggplot(aes(x = n_mutations_partis)) + geom_histogram(binwidth = 1)
# Plot with fraction of unmutate naive sequences by mouse / tissue
distribution_mutations_naive %>%
filter(n_mutations_partis == 0) %>%
ggplot(aes(x = group_controls_pooled, y = fraction_seqs, color = infection_status)) +
geom_boxplot(outlier.alpha = 0) +
geom_point() +
facet_wrap('tissue') +
background_grid()
mean_n_mutations %>% ggplot(aes(x = group_controls_pooled, y = mean_n_mutations, color = infection_status)) +
geom_point() +
geom_boxplot() +
facet_grid(tissue ~ cell_type, scales = 'free') +
background_grid()
library(dplyr)
library(tidyr)
library(readr)
library(ggplot2)
library(cowplot)
theme_set(theme_cowplot())
source('gene_frequency_functions.R')
setwd("/Volumes/cobey/mvieira/v_gene_selection/code")
library(dplyr)
library(tidyr)
library(readr)
library(ggplot2)
library(cowplot)
theme_set(theme_cowplot())
source('gene_frequency_functions.R')
seq_level_data <- read_csv('~/Desktop/seq_level_data.csv')
